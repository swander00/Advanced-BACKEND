# ===========================================
# BRAMPTON REAL ESTATE API - ENVIRONMENT CONFIGURATION
# ===========================================

# ===========================================
# SERVER CONFIGURATION
# ===========================================
PORT=3001
NODE_ENV=development
TZ=America/Toronto

# ===========================================
# SUPABASE CONFIGURATION
# ===========================================
SUPABASE_URL=https://gyeviskmqtkskcoyyprp.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd5ZXZpc2ttcXRrc2tjb3l5cHJwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODMyMzkzOCwiZXhwIjoyMDczODk5OTM4fQ.KryixRJ8n-wy1n_WySex5qkHVST_awSudkM53SaSDj0
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd5ZXZpc2ttcXRrc2tjb3l5cHJwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMjM5MzgsImV4cCI6MjA3Mzg5OTkzOH0.qDOpA1nSwWdnQhIJQiQx-rjgl800EjTU3M90iKQQDiI

# ===========================================
# AMPRE RESO WEB API TOKENS
# ===========================================
# IDX (Available listings)
IDX_TOKEN=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ2ZW5kb3IvdHJyZWIvNjI4OSIsImF1ZCI6IkFtcFVzZXJzUHJkIiwicm9sZXMiOlsiQW1wVmVuZG9yIl0sImlzcyI6InByb2QuYW1wcmUuY2EiLCJleHAiOjI1MzQwMjMwMDc5OSwiaWF0IjoxNzU4NzMzOTQ2LCJzdWJqZWN0VHlwZSI6InZlbmRvciIsInN1YmplY3RLZXkiOiI2Mjg5IiwianRpIjoiNGM0NmIyOTgxNjhhODQ5YiIsImN1c3RvbWVyTmFtZSI6InRycmViIn0.AXTWrd_GMd19uiisBbW8IoFxqKzcEZrTSErSnT0qzkY

# VOW (Unavailable/Sold listings)
VOW_TOKEN=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ2ZW5kb3IvdHJyZWIvNjI4OSIsImF1ZCI6IkFtcFVzZXJzUHJkIiwicm9sZXMiOlsiQW1wVmVuZG9yIl0sImlzcyI6InByb2QuYW1wcmUuY2EiLCJleHAiOjI1MzQwMjMwMDc5OSwiaWF0IjoxNzU4NzMzOTE3LCJzdWJqZWN0VHlwZSI6InZlbmRvciIsInN1YmplY3RLZXkiOiI2Mjg5IiwianRpIjoiNzA5NDdjMDlhZmJhM2VjMiIsImN1c3RvbWVyTmFtZSI6InRycmViIn0.xbZpVm251NtG1XyZSCswXGO4eN14oCo71Lg_iAakRsQ

# Default Access Token (switchable for pipeline)
DEFAULT_ACCESS_TOKEN=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ2ZW5kb3IvdHJyZWIvNjI4OSIsImF1ZCI6IkFtcFVzZXJzUHJkIiwicm9sZXMiOlsiQW1wVmVuZG9yIl0sImlzcyI6InByb2QuYW1wcmUuY2EiLCJleHAiOjI1MzQwMjMwMDc5OSwiaWF0IjoxNzU4NzMzOTQ2LCJzdWJqZWN0VHlwZSI6InZlbmRvciIsInN1YmplY3RLZXkiOiI2Mjg5IiwianRpIjoiNGM0NmIyOTgxNjhhODQ5YiIsImN1c3RvbWVyTmFtZSI6InRycmViIn0.AXTWrd_GMd19uiisBbW8IoFxqKzcEZrTSErSnT0qzkY

# ===========================================
# AMPRE API ENDPOINT URLs
# ===========================================
# Property feeds with cursor-based pagination for incremental sync
IDX_URL=https://query.ampre.ca/odata/Property?$filter=ContractStatus eq 'Available' and PropertyType ne 'Commercial' and (ModificationTimestamp gt @lastTimestamp or (ModificationTimestamp eq @lastTimestamp and ListingKey gt '@lastKey'))&$orderby=ModificationTimestamp,ListingKey
VOW_URL=https://query.ampre.ca/odata/Property?$filter=ContractStatus ne 'Available' and PropertyType ne 'Commercial' and (ModificationTimestamp gt @lastTimestamp or (ModificationTimestamp eq @lastTimestamp and ListingKey gt '@lastKey'))&$orderby=ModificationTimestamp,ListingKey

# Media feed - pre-filtered to largest images, excluding Commercial
MEDIA_URL=https://query.ampre.ca/odata/Media?$filter=ClassName ne 'Commercial' and ImageSizeDescription eq 'Largest'&$orderby=MediaModificationTimestamp desc

# Template for batched media fetch by property keys
MEDIA_BATCH_FILTER_TEMPLATE=$filter=ResourceRecordKey in ({keys}) and ImageSizeDescription eq 'Largest'&$orderby=MediaModificationTimestamp

# Child resources
ROOMS_URL=https://query.ampre.ca/odata/PropertyRooms?$filter=ListingKey eq '@propertyKey'&$orderby=RoomKey
OPEN_URL=https://query.ampre.ca/odata/OpenHouse?$filter=ListingKey eq '@propertyKey' and OpenHouseDate ge @today&$orderby=OpenHouseKey

# ===========================================
# SYNC CONFIGURATION
# ===========================================
BATCH_SIZE_PROPERTY=1000
BATCH_SIZE_CHILD=500
MEDIA_PROPERTY_BATCH_SIZE=500
MEDIA_PAGE_SIZE=500
MEDIA_ENFORCE_MATCHING_ONLY=true

# Optional start date for delta sync (useful for backfills)
SYNC_START_DATE=2024-01-01T00:00:00Z

# ===========================================
# RATE LIMITING
# ===========================================
AMPRE_RATE_LIMIT_PER_MINUTE=120
AMPRE_RATE_LIMIT_PER_HOUR=5000

# ===========================================
# LOGGING & DEBUGGING
# ===========================================
LOG_LEVEL=info
LOG_FILE=logs/app.log
DEBUG=true
VERBOSE_LOGGING=true

# ===========================================
# FRONTEND CONFIGURATION
# ===========================================
NEXT_PUBLIC_BACKEND_URL=http://localhost:3001